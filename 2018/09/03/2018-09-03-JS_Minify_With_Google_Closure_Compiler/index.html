<!DOCTYPE html><html><head hexo-theme="https://github.com/volantis-x/hexo-theme-volantis/tree/4.0.0-rc.1"><meta charset="utf-8"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>使用Google Closure Compiler进行Js代码压缩 - 忆星辰 | 博客</title><meta name="keywords" content="JavaScript"><meta name="description" content="The Closure Compiler is a tool for making JavaScript download and run faster. Instead of compiling from a source language to machine code, it compiles from JavaScript to better JavaScript. It parses your JavaScript, analyzes it, removes dead code and rewrites and minimizes what's left. It also checks syntax, variable references, and types, and warns about common JavaScript pitfalls."><link rel="alternate" href="/atom.xml" title="忆星辰 | 博客" type="application/atom+xml"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="shortcut icon" type="image/x-icon" href="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/avatar/favicon-cicle.png?x-oss-process=style/WebSiteCover"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"><script async referrerpolicy="no-referrer" type="text/javascript" src="//cdn.jsdelivr.net/npm/leancloud-storage@3/dist/av-min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"><link rel="stylesheet" href="/css/style.css"><script>setTimeout(function(){window.ga_tid="UA-124641144-1",function(){var e=document.createElement("script");e.src="https://rmt.dogedoge.com/fetch/public/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()},5e3)</script><script>var _hmt=_hmt||[];setTimeout(function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?e98a157d14b712d66463073d921b0253",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)},5e3)</script></head><body><header class="l_header auto shadow blur" style="opacity:0"><div class="container"><div class="wrapper"><div class="nav-sub"><p class="title"></p><ul class="switcher nav-list-h m-phone" id="pjax-header-nav-list"><li><a class="s-comment fas fa-comments fa-fw" target="_self" href="javascript:void(0)"></a></li><li><a class="s-toc fas fa-list fa-fw" target="_self" href="javascript:void(0)"></a></li></ul></div><div class="nav-main"><a class="title flat-box" target="_self" href="/"><img no-lazy class="logo" src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/avatar/favicon-cicle.png?x-oss-process=style/WebSiteCover"> <i class="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/avatar/favicon-cicle.png?x-oss-process=style/WebSiteCover"></i></a><div class="menu navigation"><ul class="nav-list-h m-pc"><li><a class="menuitem flat-box faa-parent animated-hover" href="/" id="home"><i class="fas fa-rss fa-fw"></i>博客</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>归档</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/" id="categories"><i class="fas fa-folder-open fa-fw"></i>分类</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/friends/" id="friends"><i class="fas fa-link fa-fw"></i>友链</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/artitalk/" id="artitalk"><i class="fas fa-comments fa-fw"></i>说说</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/bangumis/index.html" id="bangumisindexhtml"><i class="fas fa-tv fa-fw"></i>番剧</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>关于</a></li><li><a class="menuitem flat-box faa-parent animated-hover"><i class="fas fa-bars fa-fw"></i>小功能</a><ul class="list-v"><li><a class="menuitem flat-box faa-parent animated-hover" href="/bookmark/" id="bookmark"><i class="fas fa-bookmark fa-fw"></i>收藏夹</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="https://ssl.extingstudio.com/" target="_blank" id="https:sslextingstudiocom"><i class="fas fa-shield-alt fa-fw"></i>SSL安全验证</a></li></ul></li><li><a class="menuitem flat-box faa-parent animated-hover"><i class="fas fa-ellipsis-v fa-fw"></i>更多</a><ul class="list-v"><li><a class="menuitem flat-box faa-parent animated-hover" href="/comments/" id="comments"><i class="fas fa-file-signature fa-fw"></i>留言板</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/tools/" id="tools"><i class="fas fa-tools fa-fw"></i>工具箱</a></li></ul></li></ul></div><div class="m_search"><form name="searchform" class="form u-search-form"><i class="icon fas fa-search fa-fw"></i> <input type="text" class="input u-search-input" placeholder="Search..."></form></div><ul class="switcher nav-list-h m-phone"><li><a class="s-search fas fa-search fa-fw" target="_self" href="javascript:void(0)"></a></li><li><a class="s-menu fas fa-bars fa-fw" target="_self" href="javascript:void(0)"></a><ul class="menu-phone list-v navigation white-box"><li><a class="menuitem flat-box faa-parent animated-hover" href="/" id="home"><i class="fas fa-rss fa-fw"></i>博客</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>归档</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/categories/" id="categories"><i class="fas fa-folder-open fa-fw"></i>分类</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/friends/" id="friends"><i class="fas fa-link fa-fw"></i>友链</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/artitalk/" id="artitalk"><i class="fas fa-comments fa-fw"></i>说说</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/bangumis/index.html" id="bangumisindexhtml"><i class="fas fa-tv fa-fw"></i>番剧</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>关于</a></li><li><a class="menuitem flat-box faa-parent animated-hover"><i class="fas fa-bars fa-fw"></i>小功能</a><ul class="list-v"><li><a class="menuitem flat-box faa-parent animated-hover" href="/bookmark/" id="bookmark"><i class="fas fa-bookmark fa-fw"></i>收藏夹</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="https://ssl.extingstudio.com/" target="_blank" id="https:sslextingstudiocom"><i class="fas fa-shield-alt fa-fw"></i>SSL安全验证</a></li></ul></li><li><a class="menuitem flat-box faa-parent animated-hover"><i class="fas fa-ellipsis-v fa-fw"></i>更多</a><ul class="list-v"><li><a class="menuitem flat-box faa-parent animated-hover" href="/comments/" id="comments"><i class="fas fa-file-signature fa-fw"></i>留言板</a></li><li><a class="menuitem flat-box faa-parent animated-hover" href="/tools/" id="tools"><i class="fas fa-tools fa-fw"></i>工具箱</a></li></ul></li></ul></li></ul></div></div></div></header><div class="l_body"><div class="l_cover"><div class="cover-wrapper post dock" style="display:none"><div class="cover-backstretch"></div><div class="cover-body"><div class="top"><img no-lazy class="logo" src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/avatar/favicon-cicle.png?x-oss-process=style/WebSiteCover"></div><div class="bottom"><div class="menu navigation"><div class="list-h"><a href="/" id="home"><i class="fas fa-book fa-fw"></i><p>博客</p></a><a href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i><p>归档</p></a><a href="/friends/" id="friends"><i class="fas fa-link fa-fw"></i><p>友链</p></a><a href="/artitalk/" id="artitalk"><i class="fas fa-comments fa-fw"></i><p>说说</p></a><a href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i><p>关于</p></a></div></div></div></div><div class="scroll-down" style="display:none"><i class="fa fa-chevron-down scroll-down-effects"></i></div></div></div><div class="safearea"><div class="body-wrapper" id="pjax-container"><div id="pjax-data" style="display:none"><div id="pjax-ispage">true</div><div id="pjax-pageTitle">使用Google Closure Compiler进行Js代码压缩</div><div id="pjax-enable-cover">true</div><div id="pjax-comment-path"></div><div id="pjax-comment-placeholder"></div></div><script>document.getElementsByClassName("cover-wrapper")[0].style.display="none",document.getElementsByClassName("l_header","cover-wrapper")[0].classList.add("show")</script><div class="l_main"><article class="article post white-box reveal md shadow article-type-post" id="post" itemscope itemprop="blogPost"><div class="article-header"><div class="article-meta" id="top"><a title="使用Google Closure Compiler进行Js代码压缩" href="/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/"><img class="thumbnail lazyload placeholder" src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903132733.png"></a><h1 class="title"><a href="/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/">使用Google Closure Compiler进行Js代码压缩</a></h1><div class="new-meta-box"><div class="new-meta-item author"><a class="author" href="/about/" rel="nofollow"><img no-lazy src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/avatar/avatar.jpg?x-oss-process=style/WebSiteCover"><p>忆星辰</p></a></div><div class="new-meta-item category"><a class="notlink"><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i> <a class="category-link" href="/categories/JavaScript/">JavaScript</a></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i><p>发布于：2018年9月3日</p></a></div><div class="new-meta-item wordcount"><a class="notlink"><i class="fas fa-keyboard fa-fw" aria-hidden="true"></i><p>字数：763字</p></a></div><div class="new-meta-item readtime"><a class="notlink"><i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i><p>时长：3分钟</p></a></div><div class="new-meta-item browse leancloud"><a class="notlink"><div id="lc-pv" data-title="使用Google Closure Compiler进行Js代码压缩" data-path="/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/"><i class="fas fa-eye fa-fw" aria-hidden="true"></i> <span id="number"><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span> 次阅读</div></a></div><div class="new-meta-item comments-count"><a href="/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/#comments"><i class="fas fa-comment-dots fa-fw"></i> <span class="valine-comment-count" data-xid="/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/">0</span> <span class="leancloud-comments-count">&nbsp;</span></a></div></div></div></div><div class="article-entry" itemprop="articleBody"><h3 id="1-Google-Closure-Compiler是什么？"><a href="#1-Google-Closure-Compiler是什么？" class="headerlink" title="1.Google Closure Compiler是什么？"></a>1.Google Closure Compiler是什么？</h3><blockquote><p>The Closure Compiler is a tool for making JavaScript download and run faster. Instead of compiling from a source language to machine code, it compiles from JavaScript to better JavaScript. It parses your JavaScript, analyzes it, removes dead code and rewrites and minimizes what’s left. It also checks syntax, variable references, and types, and warns about common JavaScript pitfalls.</p><p>Closure Compiler是一个使JavaScript下载和运行更快的工具。 它不是从源语言编译到机器代码，而是从JavaScript编译成更好的JavaScript。 它解析您的JavaScript，分析它，删除死代码并重写并最小化剩下的内容。 它还检查语法，变量引用和类型，并警告常见的JavaScript陷阱。</p></blockquote><h3 id="2-使用环境"><a href="#2-使用环境" class="headerlink" title="2.使用环境"></a>2.使用环境</h3><p>平台：Mac OS<br><br>环境：Java</p><h3 id="3-检查是否安装了Java环境"><a href="#3-检查是否安装了Java环境" class="headerlink" title="3.检查是否安装了Java环境"></a>3.检查是否安装了Java环境</h3><p>打开终端，输入 <code>java -version</code>,输出java的版本说明已安装好了java，若报错，请安装java环境<br><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903132733.png?x-oss-process=image/resize,w_500" class="lazyload placeholder" data-srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903132733.png?x-oss-process=image/resize,w_500" srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/icon/img-loading-bilibili.gif"></p><h3 id="4-Closure-Compiler下载"><a href="#4-Closure-Compiler下载" class="headerlink" title="4.Closure Compiler下载"></a>4.Closure Compiler下载</h3><p>在<a target="_blank" rel="noopener" href="https://dl.google.com/closure-compiler/compiler-latest.zip">Github</a>上下载最新版的编译好的Compiler文件，解压出jar文件存放在项目外的目录下：<br><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903131934.png?x-oss-process=image/resize,w_300" class="lazyload placeholder" data-srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903131934.png?x-oss-process=image/resize,w_300" srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/icon/img-loading-bilibili.gif" alt="compiler"></p><h3 id="5-在终端中，输入命令，运行jar："><a href="#5-在终端中，输入命令，运行jar：" class="headerlink" title="5.在终端中，输入命令，运行jar："></a>5.在终端中，输入命令，运行jar：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar &#x2F;Users&#x2F;wangjun&#x2F;Git&#x2F;compiler.jar --js_output_file&#x3D;code.js &#39;&#x2F;Users&#x2F;wangjun&#x2F;Git&#x2F;WorkProject&#x2F;BallsRace&#x2F;release&#x2F;wxgame&#x2F;code.js&#39;</span><br></pre></td></tr></table></figure><p><code>/Users/wangjun/Git/compiler.jar</code> 改为自己的电脑上compiler.jar的路径，<code>code.js</code>改为输出文件名，<code>/Users/wangjun/Git/WorkProject/BallsRace/release/wxgame/code.js</code>改为输出路径。（其他参数这里使用默认）<br>运行后就可以看到生成了压缩的JS文件了。<br>压缩前后文件大小对比，压缩效果还是很明显的：<br><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903133758.png?x-oss-process=image/resize,w_300" class="lazyload placeholder" data-srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903133758.png?x-oss-process=image/resize,w_300" srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/icon/img-loading-bilibili.gif"><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903133906.png?x-oss-process=image/resize,w_310" class="lazyload placeholder" data-srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903133906.png?x-oss-process=image/resize,w_310" srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/icon/img-loading-bilibili.gif"></p><h3 id="6-使用sh脚本实现自动化打包压缩Js文件"><a href="#6-使用sh脚本实现自动化打包压缩Js文件" class="headerlink" title="6.使用sh脚本实现自动化打包压缩Js文件"></a>6.使用sh脚本实现自动化打包压缩Js文件</h3><p>由于我是使用Laya Box引擎做游戏开发的，每次打包都需要手动敲代码进行代码压缩，并且还需要手动删除打包后多余的库文件，流程实在很繁琐，所以我使用了Laya打包提供的后续执行命令功能，配合sh命令进行了打包压缩的自动化，大大提高了打包效率。<br>打开Laya Box的打包页面<br><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903134500.png?x-oss-process=image/resize,w_400" class="lazyload placeholder" data-srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903134500.png?x-oss-process=image/resize,w_400" srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/icon/img-loading-bilibili.gif"><br>编写sh命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;Users&#x2F;wangjun&#x2F;Git&#x2F;WorkProject&#x2F;BallsRace&#x2F;release&#x2F;wxgame&#x2F;</span><br><span class="line">rm -rf .&#x2F;libs</span><br><span class="line">rm -rf .&#x2F;res</span><br><span class="line">java -jar &#x2F;Users&#x2F;wangjun&#x2F;Git&#x2F;compiler.jar --js_output_file&#x3D;code.js &#39;&#x2F;Users&#x2F;wangjun&#x2F;Git&#x2F;WorkProject&#x2F;BallsRace&#x2F;release&#x2F;wxgame&#x2F;code.js&#39;</span><br></pre></td></tr></table></figure><p>保存为.sh文件<br>在后续执行脚本中填入.sh脚本的路径，在打包后就可以自动执行代码压缩，并且删除多余文件了。</p><h3 id="7-帮助"><a href="#7-帮助" class="headerlink" title="7.帮助"></a>7.帮助</h3><p>在终端中输入 <code>java -jar compiler.jar --help</code> 可以查看compiler的命令帮助和其他参数<br><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903134930.png?x-oss-process=image/resize,w_400" class="lazyload placeholder" data-srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903134930.png?x-oss-process=image/resize,w_400" srcset="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/icon/img-loading-bilibili.gif"></p><h3 id="8-其他"><a href="#8-其他" class="headerlink" title="8.其他"></a>8.其他</h3><p>我没用使用各种在线的Js代码压缩网站，原因如下：</p><ol><li>在线压缩工具受网络状况影响；</li><li>和我的需求不一致，我需要的是压缩js文件，而不只是压缩js代码片段；</li><li>无法实现自动化脚本，上传-等待-压缩-下载，比较繁琐；</li><li>我觉得上传代码压缩并不安全，有泄漏源码的风险。</li></ol><h3 id="9-其他的JavaScript代码压缩工具"><a href="#9-其他的JavaScript代码压缩工具" class="headerlink" title="9.其他的JavaScript代码压缩工具"></a>9.其他的JavaScript代码压缩工具</h3><p><a target="_blank" rel="noopener" href="https://github.com/mishoo/UglifyJS">UglifyJS</a><br><br><a target="_blank" rel="noopener" href="https://github.com/yui/yuicompressor">YUI Compressor</a><br><br><a target="_blank" rel="noopener" href="http://25.io/smaller/">Smaller</a><br><br><a target="_blank" rel="noopener" href="https://github.com/GGG-KILLER/CSS-And-Js-Minifier">Minifier</a></p><div class="footer"><div class="copyright"><blockquote><p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p><p><strong>转载请注明本文链接</strong></p><p>本文永久链接是：<a href="https://www.extingstudio.com/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/">https://www.extingstudio.com/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/</a></p></blockquote></div><div class="donate"><div class="imgs"><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/webinfos/pay-wechat.jpg?x-oss-process=style/WebSiteCover"> <img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/webinfos/pay-alipay.png?x-oss-process=style/WebSiteCover"></div></div></div></div><div class="article-meta" id="bottom"><div class="new-meta-box"><div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-08-25T15:39:15+08:00"><a class="notlink"><i class="fas fa-edit fa-fw" aria-hidden="true"></i><p>更新于：2020年8月25日</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/JavaScript/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>JavaScript</p></a></div><div class="new-meta-item share -mob-share-list"><div class="-mob-share-list share-body"><div class="hoverbox"><a class="share"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/wechat.png"></a><div class="target"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVgAAAFYCAAAAAAzB7ucAAAEZUlEQVR42u3aQZLbMAwEQP//08kLXCIGIBRXmrfNriWy6QMwweePdWV9EIAFa4EFC9YCuwL7Cde3zz/9+/EGH55bfc7Tecc8wIIFCxYsWLBgwa7C3troKdytz3XPV/YACxYsWLBgwYIF+wrsaQE9dRFTB+te1JQHWLBgwYIFCxYs2N+ArQbf3QL96ULSoB4sWLBgwYIFCxbs/wVbBT2Fu1Xop/sFCxYsWLBgwYIF+2/DThXw3YupFvhTF/bPTMKABQsWLFiwYMGCPYK9HRT/2s+xB1iwYMGCBQsWLNgV2O5KC/bqQaoNSPrFaHuABQsWLFiwYMGCXYGtDjJ0BymmBj2qwXcX+vg9YMGCBQsWLFiwYFdgTyGqjUD1992AeeqL0h0QAQsWLFiwYMGCBbsLO1WApwHydECePre7T7BgwYIFCxYsWLDvwJ4W3tMDHlONxdT7qw0TWLBgwYIFCxYs2Hdh48L48IDVv0sL9nRgI22YwIIFCxYsWLBgwe7CVgcaukFzGkSnwXu5wD8E/LpPsGDBggULFixYsKuwUy/oNhLdoL0aVMeA3z4PFixYsGDBggULdhW2O5DxOVzpBaWNRDVQT/cJFixYsGDBggUL9l3YKlC3AUgD6m5hX/3CtBsEsGDBggULFixYsCuw6UaqEN3BkDSYTs/9+MUCCxYsWLBgwYIFuwqbBrvdC6o2BOlzp97/eIFgwYIFCxYsWLBgV2CrcNXCPw2a00A9DeyrAfxj0A0WLFiwYMGCBQv2Vdh0YKO6oamBjjRI714MWLBgwYIFCxYs2F3YFGyqsZgC6A6QTAXkYMGCBQsWLFiwYHdhqwevglYbiinQqf0ePwcsWLBgwYIFCxbsKmwXLg6GL/17OpjRbZzAggULFixYsGDB7sLe+rkLnz4n3We14Sh3XmDBggULFixYsGCvwlYD57QxuFXwP/19d7/t/0EACxYsWLBgwYIF24JNg93qwVPIqQA8bUzK5wULFixYsGDBggW7Cnv7gOnvp4LxqQbl8X1gwYIFCxYsWLBgV2DTwLc6WJEG090GoDr4kZ4DLFiwYMGCBQsW7C7s1IGrB6oOZqQDGVOF//H7wYIFCxYsWLBgwa7ATg1edGGrhfhUEJ5e6HHQDRYsWLBgwYIFC/YKbPXF3QGPqYJ+KsjuAj92XmDBggULFixYsGCvwt4qxE8bgmqjMHWB0/sACxYsWLBgwYIFuwubruqFdAci0sGP218MsGDBggULFixYsLuwn3BNFdjVgn8KaOqCvg5sgAULFixYsGDBgl2BTRuCbrDchZxqJLoXAhYsWLBgwYIFC/Zd2LTAnw7OU8BbF3n8PLBgwYIFCxYsWLA/AVsNwKcC5eqgRxWoejFgwYIFCxYsWLBgfxs2bShuH7wbkB+fFyxYsGDBggULFuwrsFWA6YNuFf7V559+YcCCBQsWLFiwYMHuwlZXN6DuPndqkGT6c2DBggULFixYsGB3YK3ZBRYsWAssWLAW2KvrL+8u15yRBHFYAAAAAElFTkSuQmCC"></div></div><a class="-mob-share-qq" rel="external nofollow noopener noreferrer noopener" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.extingstudio.com/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/&title=使用Google Closure Compiler进行Js代码压缩 - 忆星辰 | 博客&pics=https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903132733.png&summary="><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qq.png"> </a><a class="-mob-share-qzone" rel="external nofollow noopener noreferrer noopener" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://www.extingstudio.com/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/&title=使用Google Closure Compiler进行Js代码压缩 - 忆星辰 | 博客&pics=https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903132733.png&summary="><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qzone.png"> </a><a class="-mob-share-weibo" rel="external nofollow noopener noreferrer noopener" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.extingstudio.com/2018/09/03/2018-09-03-JS_Minify_With_Google_Closure_Compiler/&title=使用Google Closure Compiler进行Js代码压缩 - 忆星辰 | 博客&pics=https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/20180903132733.png&summary="><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/weibo.png"></a></div></div></div></div><div class="prev-next"><a class="prev" href="/2018/09/07/2018-09-07-About_Use_of_Laya_Timer/"><p class="title"><i class="fas fa-chevron-left" aria-hidden="true"></i>关于Laya的中Timer的使用方法</p><p class="content">Laya中Timer的类1.官方文档 Laya.Timer Package laya.utils 类 public class Timer Inheritance Timer → ...</p></a><a class="next" href="/2018/08/27/2018-01-25-About_WebSocket/"><p class="title">什么是WebSocket？<i class="fas fa-chevron-right" aria-hidden="true"></i></p><p class="content">什么是WebSocket？　 　WebSocket协议是一种基于ＴＣＰ的一种新的网络协议。他实现了浏览器与服务器全双工(full-duplex)通信—-允许服务器主动发送信息给客户端。 　　　...</p></a></div></article><article class="post white-box reveal shadow" id="comments"><p ct><i class="fas fa-comments"></i> 评论</p><div id="valine_container" class="valine_thread"><i class="fas fa-cog fa-spin fa-fw fa-2x"></i></div></article></div><aside class="l_side"><section class="widget toc-wrapper shadow desktop mobile" id="toc-div"><header><i class="fas fa-list fa-fw" aria-hidden="true"></i><span class="name">本文目录</span></header><div class="content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Google-Closure-Compiler%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.</span> <span class="toc-text">1.Google Closure Compiler是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8%E7%8E%AF%E5%A2%83"><span class="toc-number">2.</span> <span class="toc-text">2.使用环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E4%BA%86Java%E7%8E%AF%E5%A2%83"><span class="toc-number">3.</span> <span class="toc-text">3.检查是否安装了Java环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Closure-Compiler%E4%B8%8B%E8%BD%BD"><span class="toc-number">4.</span> <span class="toc-text">4.Closure Compiler下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%9C%A8%E7%BB%88%E7%AB%AF%E4%B8%AD%EF%BC%8C%E8%BE%93%E5%85%A5%E5%91%BD%E4%BB%A4%EF%BC%8C%E8%BF%90%E8%A1%8Cjar%EF%BC%9A"><span class="toc-number">5.</span> <span class="toc-text">5.在终端中，输入命令，运行jar：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E4%BD%BF%E7%94%A8sh%E8%84%9A%E6%9C%AC%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E6%89%93%E5%8C%85%E5%8E%8B%E7%BC%A9Js%E6%96%87%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">6.使用sh脚本实现自动化打包压缩Js文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%B8%AE%E5%8A%A9"><span class="toc-number">7.</span> <span class="toc-text">7.帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%85%B6%E4%BB%96"><span class="toc-number">8.</span> <span class="toc-text">8.其他</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E5%85%B6%E4%BB%96%E7%9A%84JavaScript%E4%BB%A3%E7%A0%81%E5%8E%8B%E7%BC%A9%E5%B7%A5%E5%85%B7"><span class="toc-number">9.</span> <span class="toc-text">9.其他的JavaScript代码压缩工具</span></a></li></ol></div></section></aside></div><footer class="footer clearfix"><br><br><div class="aplayer-container"><meting-js theme="#1BCDFC" autoplay volume="0.5" loop order="random" fixed="true" list-max-height="320px" server="netease" type="playlist" id="3136952023" list-folded="true"></meting-js></div><div><p><img src="https://img.shields.io/badge/Powered-Hexo-blue" style="float:center"> <a href="/about"><img src="https://img.shields.io/badge/Hosted-GitHub-brightgreen" style="float:center"> </a><a target="_blank" rel="noopener" href="https://www.aliyun.com/"><img src="https://img.shields.io/badge/DNS-%E9%98%BF%E9%87%8C%E4%BA%91-orange" style="float:center"> </a><a target="_blank" rel="noopener" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-JsDelivr-blueviolet" style="float:center"> </a><a target="_blank" rel="noopener" href="https://volantis.js.org/"><img src="https://img.shields.io/badge/Theme-Volantis-blue" style="float:center"> </a><a href="/about"><img src="https://img.shields.io/github/repo-size/BillScott1024/billscott1024.github.io?color=green&label=%E6%9C%AC%E7%AB%99%E5%A4%A7%E5%B0%8F&logo=Git&logoColor=white" style="float:center"> </a><a href="/about"><img src="https://img.shields.io/github/last-commit/BillScott1024/billscott1024.github.io?color=blue&label=%E6%9C%80%E8%BF%91%E6%9B%B4%E6%96%B0&logo=Github" style="float:center"></a></p></div><br><div class="social-wrapper"><a href="https://github.com/BillScott1024/" class="social flat-btn" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/029-github.svg"> </a><a href="https://music.163.com/#/user/home?id=63035382" class="social flat-btn" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/icon/music.svg"> </a><a href="/atom.xml" class="social flat-btn" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org@1.1/icon/1322024-social-media/020-rss.svg"></a></div><div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p></div><div><p><span id="lc-sv">本站总访问量为 <span id="number"><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span> 次</span> <span id="lc-uv">访客数为 <span id="number"><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span> 人</span></p></div><div class="copyright"><p><a href="/">Copyright © 2017-2020 ExtingStudio</a></p></div><div><div style="width:300px;margin:0 auto;padding:20px 0"><a style="display:inline-block;text-decoration:none;height:20px;line-height:20px"><img src="https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/icon/beian.png" style="float:left"><p style="float:left;height:20px;line-height:20px;margin:0;color:#939393">鄂公网安备 42011102002596号</p></a></div></div></footer><a class="s-top fas fa-arrow-up fa-fw" href="javascript:void(0)"></a></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@3.5/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script>function pjax_fancybox(){$(".md").find("img").not(".inline").not("a img").each(function(){var t=document.createElement("a");$(t).attr("class","fancybox"),$(t).attr("pjax-fancybox",""),$(t).attr("href",$(this).attr("src")),$(this).attr("data-original")&&$(t).attr("href",$(this).attr("data-original")),$(t).attr("data-fancybox","images");var a="";$(this).attr("alt")&&($(t).attr("data-caption",$(this).attr("alt")),a=$(this).attr("alt"));var e=document.createElement("div");$(e).addClass("fancybox"),$(this).wrap(e);var r=document.createElement("span");$(r).addClass("image-caption"),$(r).text(a),$(this).after(r);var i=document.createElement("div");$(i).addClass("bg"),$(this).attr("bg")&&$(i).css("background",$(this).attr("bg")),$(this).wrap(i),$(this).wrap(t)}),$(".article-entry").find("img").fancybox({selector:'[data-fancybox="images"]',hash:!1,loop:!1,closeClick:!0,helpers:{overlay:{closeClick:!0}},buttons:["zoom","close"]})}$(function(){pjax_fancybox()})</script><script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script><script type="text/javascript">$(function(){var o=["https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-01.jpg","https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-02.jpg","https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-03.png","https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-04.jpg","https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-05.jpg","https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-06.png","https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-07.jpg","https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-08.jpg","https://es-blogimg.oss-cn-hangzhou.aliyuncs.com/img/covers/cover-09.jpg"];!function(o){for(var s=o.length;s--;){var c=Math.floor(Math.random()*s),g=o[c];o[c]=o[s],o[s]=g}}(o),$(".cover-backstretch").backstretch(o,{duration:"10000",fade:"1500"})})</script><script>var SEARCH_SERVICE="hexo",ROOT="/";ROOT.endsWith("/")||(ROOT+="/")</script><script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script><script>window.lazyLoadOptions={elements_selector:".lazyload",threshold:0},window.addEventListener("LazyLoad::Initialized",function(n){window.lazyLoadInstance=n.detail.instance},!1),document.addEventListener("DOMContentLoaded",function(){lazyLoadInstance.update()}),document.addEventListener("pjax:complete",function(){lazyLoadInstance.update()})</script><script>window.FPConfig={delay:0,ignoreKeywords:[],maxRPS:5,hoverDelay:25}</script><script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script><script>var clipboard = new ClipboardJS('.btn-copy', {
        target: function (trigger) {
            return trigger.nextElementSibling
        }
    });
    function wait(callback, seconds) {
        var timelag = null;
        timelag = window.setTimeout(callback, seconds)
    }
    function pjax_initCopyCode() {
		if($(".highlight .code pre").length+$(".article pre code").length==0)return;
        var copyHtml = '';
        copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
        copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
        copyHtml += '</button>';
        $(".highlight .code pre").before(copyHtml);
        $(".article pre code").before(copyHtml);
        clipboard.off('success').on('success', function (e) {
            let $btn = $(e.trigger);
            $btn.addClass('copied');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-check-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPIED';
            wait(function () {
                $icon.removeClass('fa-check-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        });
        clipboard.off('error').on('error', function (e) {
            e.clearSelection();
            let $btn = $(e.trigger);
            $btn.addClass('copy-failed');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-times-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPY FAILED';
            wait(function () {
                $icon.removeClass('fa-times-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        })
    }
    $(function () {
        pjax_initCopyCode()
    });</script><script>let APlayerController = new Object();
  APlayerController.id = '3136952023';  // 设定全局音乐播放ID
  APlayerController.volume = '0.5';</script><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><script src="/js/aplayer.js"></script><script src="https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js"></script><script>var GUEST_INFO = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link'.split(',').filter(function (item) {
    return GUEST_INFO.indexOf(item) > -1
  });
  var REQUIRED_FIELDS = ['nick', 'mail', 'link'];
  var requiredFields = 'nick,mail'.split(',').filter(function (item) {
    return REQUIRED_FIELDS.indexOf(item) > -1
  });

  function emoji(path, idx, ext) {
    return path + "/" + path + "-" + idx + "." + ext;
  }

  var emojiMaps = {};
  for (var i = 1; i <= 101; i++) {
    emojiMaps['qq-' + i] = emoji('qq', i, 'gif');
  }
  for (var i = 1; i <= 4; i++) {
    emojiMaps['weibo-' + i] = emoji('weibo', i, 'png');
  }

  for (var i = 1; i <= 54; i++) {
    emojiMaps['tieba-' + i] = emoji('tieba', i, 'png');
  }

  for (var i = 1; i <= 116; i++) {
    emojiMaps['aru-' + i] = emoji('aru', i, 'gif');
  }
  for (var i = 1; i <= 125; i++) {
    emojiMaps['twemoji-' + i] = emoji('twemoji', i, 'png');
  }


  function pjax_valine() {
    if (!document.querySelectorAll("#valine_container")[0]) return;

    let pagePlaceholder = $.trim($('#pjax-comment-placeholder').text()) || "粘贴图片到此处可以自动上传，请填写邮箱以收到及时回复哦~";

    let path = $.trim($('#pjax-comment-path').text());
    if (path.length == 0) {
      let defaultPath = '';
      path = defaultPath || decodeURI(window.location.pathname);
    }

    var valine = new Valine();
    valine.init({
      el: '#valine_container',
      meta: meta,
      placeholder: pagePlaceholder,
      path: path,
      appId: "OcH33On9kof4QnMnSaAOmDhj-MdYXbMMI",
      appKey: "V50w1D4JtUK9s3VxbnTtg5XJ",
      pageSize: '10',
      avatar: 'wavatar',
      lang: 'zh-cn',
      visitor: 'true',
      highlight: 'true',
      mathJax: 'false',
      enableQQ: 'true',
      requiredFields: requiredFields,
      emojiCDN: 'https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/valine/',
      emojiMaps: emojiMaps,
      master: '99f30fa72c5a1da511002a1122a78a36',
      friends: '',
      tagMeta: ['博主','小伙伴','访客'],
      metaPlaceholder: { "nick": "昵称/QQ号", "mail": "邮箱（必填/完全保密）", 'link': '可不填' },
    });


  }

        function pjax_newcomment() {

          function queryLeanCloud(k) {
            let root = this;
            let len = arguments.length;
            if (len == 1) {
              if (!AV) {
                console.log("no the fuck AV object!!");
                return;
              }
              let notExist = new AV.Query("Comment");
              notExist.doesNotExist('rid');
              let isEmpty = new AV.Query("Comment");
              isEmpty.equalTo('rid', '');
              let q = AV.Query.or(notExist, isEmpty);
              if (k === '*') q.exists('url');
              else q.equalTo('url', decodeURI(k));
              q.addDescending('createdAt');
              q.addDescending('insertedAt');
              return q;
            } else {
              let ids = JSON.stringify(arguments[1]).replace(/(\[|\])/g, '');
              let cql = `select * from ${root['config']['clazzName']} where rid in (${ids}) order by -createdAt,-createdAt`;
              return AV.Query.doCloudQuery(cql)
            }
          }
          var valine = new Valine({
            el: '#valine_container_ba（因为主题已经有valine的这些参数了，这里随意填都行）',
            app_id: "OcH33On9kof4QnMnSaAOmDhj-MdYXbMMI",
            app_key: "V50w1D4JtUK9s3VxbnTtg5XJ",
            placeholder: '',
            serverURLs: 'https://api-latestcomments-v2.extingstudio.com'
          });

          //判断博主，heson改为自己的昵称
          function bozhu(e) {
            if (e == "jaxsonwang@foxmail.com") {
              mail = e + '[博主]'
              return mail;
            } else {
              return e
            }
          }

          //判断网址
          function wangzhi(e) {
            http = e.slice(0, 4)
            https = e.slice(0, 5)
            if (http == "http" || https == "https") {
              return e
            } else if (e == "" || e == null || e == undefined) {
              return e
            } else {
              e = 'http://' + e
              return e
            }
          }

          //查询评论
          valine.Q('*').limit(7).find().then(function (comments) {
            var hotComments = $("#hot-comments");
            for (var i = 0; i < comments.length; i++) {
              if (i === 0) {
                // console.log(comments[0]);
              }
              var mail = bozhu(comments[i]._serverData.mail);
              var nick = comments[i]._serverData.nick;
              var content = comments[i]._serverData.comment;
              var newcontent = content.substring(0, 50).replace(/<[^>]+>/g, "");
              var url = comments[i]._serverData.url;
              var link = wangzhi(comments[i]._serverData.link);
              var updatedAt = timeago(comments[i].updatedAt);
              var commentId = '#' + comments[i].id;
              hotComments.append('<div class="card-comment-item"><div class="item-header-text"><a href="' + link + '" target="_blank" rel="nofollow noopener noreferrer" class="newcomment" >' + nick + '</a>&nbsp;发表于' + updatedAt + '</div><div class="item-text"><a href="' + url + commentId + '"  rel="nofollow" style="color:#717171" class="comments-detail" >' + newcontent + '</a></div></div>');
            }
          });
        }

      

  $(function () {
    pjax_valine();
    pjax_newcomment();

  });</script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5/lib/darkmode-js.min.js" aysc></script><script type="text/javascript">function getClientHeight(){var e=0;if(document.body.clientHeight&&document.documentElement.clientHeight)e=document.body.clientHeight<document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight;else e=document.body.clientHeight>document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight;return e}function supportCss3(e){var t,o=["webkit","Moz","ms","o"],n=[],d=document.documentElement.style,i=function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})};for(t in o)n.push(i(o[t]+"-"+e));for(t in n.push(i(e)),n)if(n[t]in d)return!0;return!1}var options={bottom:"100px",right:"unset",left:"16px",time:"0s",mixColor:"#f4f4f4",backgroundColor:"#f4f4f4",buttonColorDark:"#333",buttonColorLight:"#ddd",saveInCookies:!0,label:"",autoMatchOsTheme:!0};function pjax_darkmodejs(){if(supportCss3("mix-blend-mode"))var e=setInterval(function(){if("undefined"!=typeof jQuery){clearInterval(e);var t=getClientHeight();$(window).scroll(function(){var e=$(document).scrollTop();t<e?($(".darkmode-layer").css("mix-blend-mode","normal"),$(".darkmode-layer").css("background-color","#222")):($(".darkmode-layer").css("mix-blend-mode","difference"),$(".darkmode-layer").css("background-color",""))})}},100)}supportCss3("mix-blend-mode")&&(window.darkmode=new Darkmode(options),window.darkmode.showWidget(),pjax_darkmodejs())</script><script defer src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js" data-pjax></script><script src="/js/app.js"></script><script src="/js/search.js"></script><script defer>const LCCounter = {
    app_id: 'OcH33On9kof4QnMnSaAOmDhj-MdYXbMMI',
    app_key: 'V50w1D4JtUK9s3VxbnTtg5XJ',
    custom_api_server: '',

    // 查询存储的记录
    getRecord(Counter, url, title) {
      return new Promise(function (resolve, reject) {
        Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({url})))
          .then(resp => resp.json())
          .then(({results, code, error}) => {
            if (code === 401) {
              throw error;
            }
            if (results && results.length > 0) {
              var record = results[0];
              resolve(record);
            } else {
              Counter('post', '/classes/Counter', {url, title: title, times: 0})
                .then(resp => resp.json())
                .then((record, error) => {
                  if (error) {
                    throw error;
                  }
                  resolve(record);
                }).catch(error => {
                console.error('Failed to create', error);
                reject(error);
              });
            }
          }).catch((error) => {
          console.error('LeanCloud Counter Error:', error);
          reject(error);
        });
      })
    },

    // 发起自增请求
    increment(Counter, incrArr) {
      return new Promise(function (resolve, reject) {
        Counter('post', '/batch', {
          "requests": incrArr
        }).then((res) => {
          res = res.json();
          if (res.error) {
            throw res.error;
          }
          resolve(res);
        }).catch((error) => {
          console.error('Failed to save visitor count', error);
          reject(error);
        });
      });
    },

    // 构建自增请求体
    buildIncrement(objectId) {
      return {
        "method": "PUT",
        "path": `/1.1/classes/Counter/${ objectId }`,
        "body": {
          "times": {
            '__op': 'Increment',
            'amount': 1
          }
        }
      }
    },

    // 校验是否为有效的 UV
    validUV() {
      var key = 'LeanCloudUVTimestamp';
      var flag = localStorage.getItem(key);
      if (flag) {
        // 距离标记小于 24 小时则不计为 UV
        if (new Date().getTime() - parseInt(flag) <= 86400000) {
          return false;
        }
      }
      localStorage.setItem(key, new Date().getTime().toString());
      return true;
    },

    addCount(Counter) {
      var enableIncr = '' === 'true' && window.location.hostname !== 'localhost';
      enableIncr = true;
      var getterArr = [];
      var incrArr = [];
      // 请求 PV 并自增
      var pvCtn = document.querySelector('#lc-sv');
      if (pvCtn || enableIncr) {
        var pvGetter = this.getRecord(Counter, 'https://www.extingstudio.com' + '/#lc-sv', 'Visits').then((record) => {
          incrArr.push(this.buildIncrement(record.objectId))
          var eles = document.querySelectorAll('#lc-sv #number');
          if (eles.length > 0) {
            eles.forEach((el,index,array)=>{
              el.innerText = record.times + 1;
              if (pvCtn) {
                pvCtn.style.display = 'inline';
              }
            })
          }
        });
        getterArr.push(pvGetter);
      }

      // 请求 UV 并自增
      var uvCtn = document.querySelector('#lc-uv');
      if (uvCtn || enableIncr) {
        var uvGetter = this.getRecord(Counter, 'https://www.extingstudio.com' + '/#lc-uv', 'Visitors').then((record) => {
          var vuv = this.validUV();
          vuv && incrArr.push(this.buildIncrement(record.objectId))
          var eles = document.querySelectorAll('#lc-uv #number');
          if (eles.length > 0) {
            eles.forEach((el,index,array)=>{
              el.innerText = record.times + (vuv ? 1 : 0);
              if (uvCtn) {
                uvCtn.style.display = 'inline';
              }
            })
          }
        });
        getterArr.push(uvGetter);
      }

      // 请求文章的浏览数，如果是当前页面就自增
      var allPV = document.querySelectorAll('#lc-pv');
      if (allPV.length > 0 || enableIncr) {
        for (i = 0; i < allPV.length; i++) {
          let pv = allPV[i];
          let title = pv.getAttribute('data-title');
          var url = 'https://www.extingstudio.com' + pv.getAttribute('data-path');
          if (url) {
            var viewGetter = this.getRecord(Counter, url, title).then((record) => {
              // 是当前页面就自增
              if (pv.getAttribute('data-path') == window.location.pathname) {
                incrArr.push(this.buildIncrement(record.objectId));
              }
              if (pv) {
                var ele = pv.querySelector('#lc-pv #number');
                if (ele) {
                  if (pv.getAttribute('data-path') == window.location.pathname) {
                    ele.innerText = (record.times || 0) + 1;
                  } else {
                    ele.innerText = record.times || 0;
                  }
                  pv.style.display = 'inline';
                }
              }
            });
            getterArr.push(viewGetter);
          }
        }
      }

      // 如果启动计数自增，批量发起自增请求
      if (enableIncr) {
        Promise.all(getterArr).then(() => {
          incrArr.length > 0 && this.increment(Counter, incrArr);
        })
      }

    },


    fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${ api_server }/1.1${ url }`, {
          method,
          headers: {
            'X-LC-Id': this.app_id,
            'X-LC-Key': this.app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      this.addCount(Counter);
    },

    refreshCounter() {
      var api_server = this.app_id.slice(-9) !== '-MdYXbMMI' ? this.custom_api_server : `https://${ this.app_id.slice(0, 8).toLowerCase() }.api.lncldglobal.com`;
      if (api_server) {
        this.fetchData(api_server);
      } else {
        fetch('https://app-router.leancloud.cn/2/route?appId=' + this.app_id)
          .then(resp => resp.json())
          .then(({api_server}) => {
            this.fetchData('https://' + api_server);
          });
      }
    }

  };

  LCCounter.refreshCounter();

  document.addEventListener('pjax:complete', function () {
    LCCounter.refreshCounter();
  });</script><!-- more --><script type="text/javascript" src="https://js.users.51.la/20919671.js"></script><script>!function(e,s,p,u){if(void 0===e.webpushr){e.webpushr=e.webpushr||function(){(e.webpushr.q=e.webpushr.q||[]).push(arguments)};var r,i=s.getElementsByTagName(p)[0];(r=s.createElement(p)).id="webpushr-jssdk",r.src="https://cdn.webpushr.com/app.min.js",i.parentNode.appendChild(r)}}(window,document,"script"),webpushr("setup",{key:"BNKbIvI_iJuSO3IFPx6D_gSjEve8q7iuxD8qMSMRfWMq0JSx0xRSadjd-x6TX8XI537fa3c7fGsgeic-ejD6l-o"})</script><script type="text/javascript" color="112, 128, 144" opacity="0.8" zindex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/BillScott1024/cdn-blog/js/copy-0.0.8.min.js"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><div class="pjax-animate"><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><div id="loading-bar-wrapper"><script>NProgress.configure({parent:"#loading-bar-wrapper",trickleSpeed:100})</script></div><script>window.ShowLoading=function(){NProgress.start()},window.HideLoading=function(){NProgress.done()}</script></div><script>var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox])',
        selectors: [
          "title",
          "#pjax-container",
          "#pjax-header-nav-list"
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000
      });
    });

    document.addEventListener('pjax:send', function (e) {
      try {
        window.stop(); // 相当于点击了浏览器的停止按钮
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = ["/artitalk/"];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {
        console.warn("addEventListener error", error);
      }

      window.subData = null; // 移除标题（用于一二级导航栏切换处）
      $.fancybox.close();    // 关闭弹窗
      $('.l_header .switcher .s-search').removeClass('active'); // 关闭移动端激活的搜索框
      $('.l_header').removeClass('z_search-open'); // 关闭移动端激活的搜索框
      $('.wrapper').removeClass('sub'); // 跳转页面时关闭二级导航

      // 解绑事件 避免重复监听
      $('.s-top').unbind('click');
      $('.menu a').unbind('click');
      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');
      window.ShowLoading();
    });

    document.addEventListener('pjax:complete', function () {
      // 关于百度统计对 SPA 页面的处理：
      // 方案一：百度统计>管理>单页应用设置中，打开开启按钮即可对SPA进行统计。 https://tongji.baidu.com/web/help/article?id=324
      // 方案二：取消注释下列代码。 https://tongji.baidu.com/web/help/article?id=235
      // 
      // _hmt.push(['_trackPageview', document.location.pathname]);
      // 

      // 关于谷歌统计对 SPA 页面的处理：
      // 当应用以动态方式加载内容并更新地址栏中的网址时，也应该更新通过 gtag.js 存储的网页网址。
      // https://developers.google.cn/analytics/devguides/collection/gtagjs/single-page-applications?hl=zh-cn
      
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('config', 'UA-124641144-1', {'page_path': document.location.pathname});
      

      $('.nav-main').find('.list-v').not('.menu-phone').removeAttr("style",""); // 移除小尾巴的移除
      $('.menu-phone.list-v').removeAttr("style",""); // 移除小尾巴的移除
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
      try{
        pjax_fancybox();
        
          
          if ('.cover-backstretch') {
            $('.cover-backstretch').backstretch("resize");
            if($('.cover-wrapper').is(':hidden')){
              $('.cover-backstretch').backstretch("pause");
            }else{
              $('.cover-backstretch').backstretch("next");
            }
          } else {
            $.backstretch("resize");
            if($('.cover-wrapper').is(':hidden')){
              $.backstretch("pause");
            }else{
              $.backstretch("next");
            }
          }
        
        
        
        
          pjax_initCopyCode();
        
        
          pjax_valine();
          pjax_newcomment();
        
        
        
        
        
          pjax_darkmodejs();
        
      } catch (e) {
        console.log(e);
      }
      window.HideLoading();
    });

    document.addEventListener('pjax:error', function (e) {
      window.HideLoading();
      window.location.href = e.triggerElement.href;
    });</script></div><script>(function(w,d, s, id) {w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};var js, fjs = d.getElementsByTagName(s)[0];js = d.createElement(s); js.id = id;js.src = 'https://cdn.webpushr.com/app.min.js';fjs.parentNode.appendChild(js);}(window,document, 'script', 'webpushr-jssdk'));webpushr('init','BNKbIvI_iJuSO3IFPx6D_gSjEve8q7iuxD8qMSMRfWMq0JSx0xRSadjd-x6TX8XI537fa3c7fGsgeic-ejD6l-o');</script></body></html>